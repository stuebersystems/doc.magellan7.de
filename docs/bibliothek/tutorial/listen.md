# Effizient mit Listen/Tabellen arbeiten

Bei der Arbeit in MAGELLAN-BIBLIOTHEK haben Sie mit einer Vielzahl von Listen bzw. Tabellen zu tun. Damit Sie das Programm optimal nutzen können, müssen Sie wissen, wie Sie diese Instrumente einsetzen können. Dabei steht Ihnen eine Reihe von Funktionen zur Verfügung, die Ihnen die Arbeit mit dem Programm erleichtert. Diese Funktionen betreffen z.B. die Darstellung und Auswahl der Listeneinträge sowie die Navigation innerhalb einer Tabelle.

Die in MAGELLAN-BIBLIOTHEK vorhandenen Tabellen lassen sich in zwei grundlegende Listenarten unterteilen:

## Stammdaten- und Vorgangslisten

Diese Tabellen enthalten die Daten, die Sie in den unterschiedlichen Ansichten erfassen bzw. erzeugen. Sie sind in den verschiedenen Ansichten auf eine Reihe von Registerkarten verteilt. Beispiele für diese Art von Listen sind die Auswahlliste der `Bücher/ Medien`, die Auswahllisten in den Ansichten `Schüler`, `Lehrer` und `Personen` oder die Liste der laufenden Leihvorgänge in der Ansicht `Vorgänge`.

## Schlüsselverzeichnisse

Diese Tabellen enthalten Daten, die Sie über `Extras > Schlüsselverzeichnisse` erfassn. Schlüsselverzeichnisse haben in MAGELLAN allgemein die Funktion Ihnen die Erfassung bzw. das Eingeben von Daten zu erleichtern. Auf diese Listen greifen Sie über das Aufklappmenü zahlreicher Auswahlfelder auf den Registerkarten der verschiedenen Ansichten oder in den Dialogfenstern diverser Datenbankassistenten zu. Beispiele für diese Art von Listen sind die Verzeichnisse `Medienjahrgänge` oder `Medienzustände`.
Die beiden Listenarten teilen eine Reihe von Gemeinsamkeiten, unterscheiden sich aber auch in verschiedenen Aspekten. Deshalb soll im Folgenden der Umgang mit diesen beiden Instrumenten gesondert behandelt werden.

## Mit Stammdaten- und Vorgangslisten arbeiten

In den vorherigen Abschnitten haben Sie bereits einige Kenntnisse erlangt, die die Arbeit mit einzelnen Stammdaten- und Vorgangslisten betreffen. So haben Sie z.B. jeweils gelernt wie Sie neue Einträge hinzufügen und alte Einträge entfernen können. Die Arbeitsschritte, die dafür im Einzelnen erforderlich sind, unterscheiden sich von Liste zu Liste. Der vorliegende Abschnitt konzentriert sich auf Funktionen, deren Ausführung in allen Listen identische Teilschritte umfasst. Dies betrifft die folgenden Funktionen:

* Zwischen Zeilen navigieren
* Spalten verschieben
* Listen sortieren
* Listen gruppieren
* Listen filtern
* Listeneinträge auswählen
* Listen ausdrucken
* Listen exportieren
* Serienbrief erstellen

## Zwischen Listenzeilen navigieren

Für das Navigieren zwischen Zeilen stehen Ihnen in der Symbolleiste des Programmfensters vier Schaltflächen zur Verfügung. Sie können alternativ auch Tastaturbefehle nutzen, um sich zwischen Zeilen zu bewegen.
• Betätigen Sie die Schaltfläche `Erster Datensatz` oder die Tastenkombination Strg+Start, um zur ersten Listenzeile zu gelangen.
• Betätigen Sie die Schaltfläche `Vorheriger Datensatz` oder die Tastenkombination Strg+BildAuf, um zur vorherigen Listenzeile zu gelangen.
• Betätigen Sie die Schaltfläche `Nächster Datensatz` oder die Tastenkombination Strg+BildAb, um zur nächsten Listenzeile zu gelangen.
• Betätigen Sie die Schaltfläche `Letzter Datensatz` und die Tastenkombination Strg+Ende, um zur letzten Listenzeile zu gelangen.

## Spalten verschieben

Sie können die Reihenfolge der Spalten verändern, indem Sie einzelne Spalten an eine neue Position verschieben. Um eine Spalte zu verschieben, führen Sie bitte die folgenden Schritte aus:

1. Klicken Sie mit der linken Maustaste auf den Spaltenkopf und halten Sie die Taste gedrückt.
2. Bewegen Sie die Maus seitwärts an den anderen Spaltenköpfen entlang: ein transparentes Duplikat des angeklickten Spaltenkopfes wird mitgezogen. Jeweils am Ende eines Spaltenkopfes erscheinen zwei grüne Pfeile. Diese Pfeile zeigen an, dass Sie den angeklickten Spaltenkopf hier einfügen können.
3. Lassen Sie die linke Maustaste los, sobald Sie die gewünschte Stelle erreichen und die zwei grünen Pfeile erscheinen.
Die ausgewählte Spalte wird nun an diese Stelle verschoben.

## Listen sortieren

Sie haben die Möglichkeit, eine gesamte Liste nach einzelnen oder mehreren Spalten zu sortieren Sortiert wird alphanummerisch, also nach Buchstaben und/ oder Zahlen. Außerdem können Sie wählen, ob die Spalte aufwärts oder abwärts sortiert werden soll. Auf diese Weise können Sie ganze Listen nach einzelnen oder mehreren Kriterien wie z.B. Schüler und/ oder Klasse sortieren.

Um eine Liste nach einer einzelnen Spalte zu sortieren, klicken Sie mit der linken Maustaste auf den Kopf der Spalte, nach der sortiert werden soll. Die gesamte Liste wird nach der Spalte aufwärts sortiert. Wenn Sie die Sortierrichtung ändern möchten, so klicken Sie erneut auf den Spaltenkopf und die Sortierrichtung wird umgekehrt.

Wenn Sie eine Liste nach mehreren Spalten gleichzeitig sortieren möchten, so gehen Sie bitte folgendermaßen vor:

1. Klicken Sie mit der `linken Maustaste` auf den Kopf der Spalte nach der als Erstes sortiert werden soll: Die gesamte Liste wird nach dieser Spalte aufwärts sortiert.
2. Halten Sie die `Shift-Taste` gedrückt und klicken Sie mit der linken Maustaste auf den Kopf einer zweiten Spalte, nach der sortiert werden soll.

Auf diese Weise wird innerhalb der ersten Sortierung eine weitere Sortierung vorgenommen. So können Sie z.B. in der Liste der ausleihberechtigten Schüler zunächst nach Klassenzugehörigkeit und dann zusätzlich nach Nachname sortieren.

## Listen gruppieren

Sie haben die Möglichkeit eine gesamt Liste nach einzelnen oder mehreren Spalten zu gruppieren. Das Gruppieren ist gerade bei sehr umfangreichen Listen eine besonders übersichtliche Alternative zum Sortieren. Es führt dazu, dass die Listeneinträge nicht nur in eine fortlaufende Reihenfolge gebracht werden, sondern darüberhinaus auch grafisch zu überschaubaren Zeilenpaketen zusammengefasst werden.

Um eine Liste nach einer einzelnen Spalte zu gruppieren, führen Sie bitte folgende Schritte durch:

1. Klicken Sie mit der `linken Maustaste` auf den Kopf einer Spalte nach der Sie gruppieren wollen
2. Halten Sie die `linke Maustaste` gedrückt und ziehen Sie den Spaltenkopf in den dunkelgrauen Bereich direkt über den Spaltenköpfen
3. Platzieren Sie den Spaltenkopf in den grauen Bereich, indem Sie die linke Maustaste freigeben
Sie erhalten nun eine veränderte Listendarstellung.

![Hier wurde die Liste der Bücher/Medien nach der Spalte `Autor` gruppiert. Sie sehen einen Gruppierungsbalken für jeden Autor. Der Gruppierungsbalken für den Autor `Johann W. von Goethe` ist zu einer Teilliste mit den vollständigen Listendaten zu diesem Spaltenelement aufgeklappt.](/assets/images/bibliothek/listen01.png)

Die gesamte Liste besteht nun aus einer Reihe grauer Gruppierungsbalken, auf denen jeweils nur die Listenelemente der gruppierten Spalte ausgewiesen sind. Die Informationen aus allen anderen Spalten bleiben hingegen ausgeblendet. Die einzelnen Gruppierungsbalken können jeweils zu Teillisten auf- und wieder zugeklappt werden, welche die ausgeblendeten Informationen zu dem betreffenden Spaltenelement enthalten.

Um den Gruppierungsbalken eines Spaltenelements zur Teilliste aufzuklappen, betätigen Sie bitte die Schaltfläche mit dem Plussymbol am Anfang des Balkens. Die Teilliste öffnet sich und aus dem Plussymbol wird ein Minussymbol. Um die Teilliste wieder einzuklappen, klicken Sie bitte mit der linken Maustaste auf das Minussymbol.

Sie können außerdem eine Liste nach mehreren Spalten gruppieren. Ziehen Sie dafür einfach noch weitere Spaltenköpfe in den dunkelgrauen Bereich über den Spalten. Auf diese Weise erhalten Sie eine mehrfach verschachtelte Darstellung.

![Hier wurde die Liste der Bücher/Medien nach den Spalten `Autor` und `Kategorie` gruppiert. Der Gruppierungsbalken für den Autor Friedrich von Schiller enthält selbst wiederum zwei Gruppierungsbalken für die Kategorien `Bellet` und `Klassik`, die jeweils zu einer Teilliste aufgeklappt sind. ](/assets/images/bibliothek/listen02.png)

Die Gruppierungsbalken der erstgruppierten Spalte enthalten die Gruppierungsbalken der nachfolgend gruppierten Spalten. Die Gruppierungsbalken der letztgruppierten Spalte können zur Teilliste aufgeklappt werden.

## Listen filtern

Sie haben die Möglichkeit eine ganze Liste nach einzelnen oder mehreren Spalten zu filtern. Das Filtern führt dazu, dass nur die Einträge angezeigt werden, auf die der gewählte Filter passt. Dabei stehen Ihnen zwei Wege zur Verfügung, um den Filter an Ihre Bedürfnisse anzupassen.

1. Filtern nach ganzen Zellinhalten
2. Filtern nach einer benutzerdefinierten Kombination von Merkmalen

![Hier wurde die Liste der Bücher/Medien nach der Spalte `Autor` gefiltert.](/assets/images/bibliothek/listen03.png)

### Nach ganzen Zellinhalten filtern

Wenn Sie nach den ganzen Zellinhalten einer Spalte filtern, dann werden Ihnen alle Listeneinträge gezeigt, die den ausgewählten Zellinhalten entsprechen. So können Sie sich z.B. alle Zeilen der Liste `Bücher/ Medien` anzeigen lassen, die einen bestimmten identischen Eintrag in der Spalte Autor haben. Dabei stehen Ihnen alle Zellinhalte einer Spalte als möglicher Filter zur Verfügung. Um nach ganzen Zellinhalten zu filtern, gehen Sie bitte folgendermaßen vor:

1. Platzieren Sie den Mauszeiger über dem gewünschten Spaltenkopf: auf der rechten Seite des Spaltenkopfes erscheint eine Pfeilschaltfläche
2. Klicken Sie mit der linken Maustaste auf diese Pfeilschaltfläche und setzen Sie im Aufklappmenü den Haken im Kontrollkästchen vor einem oder mehreren der gewünschten Zellinhalten
   
Die Liste verkleinert sich automatisch auf einen Ausschnitt der Zeilen, die die ausgewählten Zellinhalte aufweisen. Wenn Sie mehrere Zellinhalte auswählen, dann geschieht die Verknüpfung dieser Zellinhalte mit dem Suchoperator `oder`. Das bedeutet, dass eine Zeile einen der angekreuzten Zellinhalte aufweisen muss, um angezeigt zu werden.

![Hier sehen Sie die Liste der Bücher/Medien, die nach dem Autor `Friedrich von Schiller` gefiltert wird.](/assets/images/bibliothek/listen03.png)

Sie können diese Liste nun weiter Filtern, indem Sie zusätzliche Zellinhalte aus anderen Spalten der Liste hinzufügen. Wählen Sie dazu einfach auf die oben beschriebene Weise einen oder mehrere Zellinhalt/e der nächsten Spalte aus.

So können Sie z.B. die bereits nach einem bestimmten Autor gefilterte Liste zusätzlich nach dem Titel einschränken. Die Verknüpfung der Zellinhalte zu einem Filter geschieht dabei mit dem Suchoperator `und`. Dies bedeutet, dass eine Zeile einen der angekreuzten Zellinhalte der Spalte A sowie einen der angehakten Zellinhalte der Spalte B aufweisen muss, um angezeigt zu werden.

![Hier sehen Sie die Liste der Bücher/Medien, die nach dem Autor `Friedrich von Schiller` und dem Titel `Die Räuber` gefiltert wird.](/assets/images/bibliothek/listen04.png)

Die aktuell gesetzten Filterparameter erscheinen in unteren Rand des Listenfensters. Um den gesetzten Filter zu entfernen, betätigen Sie einfach die `X`-Schaltfläche zum Schließen am linken Rand dieses Balkens.

### Einen benutzerdefinierten Filter setzen

Sie haben darüberhinaus die Möglichkeit nach Teilen von Zellinhalten zu filtern und diese Elemente spaltenübergreifend zu kombinieren. Um diese erweiterten Optionen zu nutzen, müssen Sie einen benutzerdefinierten Filter erzeugen. Dazu steht Ihnen ein eigenes Dialogfenster zur Verfügung. Um dieses Dialogfenster aufzurufen, führen Sie bitte folgende Schritte aus:

1. Platzieren Sie den Mauszeiger über dem gewünschten Spaltenkopf: auf der rechten Seite des Spaltenkopfes erscheint eine Pfeilschaltfläche
2. Betätigen Sie diese Pfeilschaltfläche und klicken Sie im Aufklappmenü mit der linken Maustaste auf den Eintrag `(Benutzerdefiniert…)`
3. Es erscheint das Dialogfenster `Benutzerdefinierter Filter`, in dem Sie einen Filter erzeugen können.

![Hier sehen Sie das Dialogfenster `Benutzerdefinierter Filter`, in dem Sie Ihre Filterkriterien individuell anpassen können.](/assets/images/bibliothek/listen05.png)

Im Dialogfenster `Benutzerdefinierter Filter` stehen Ihnen auf der rechten Seite zwei Felder für die Eingabe eines Suchbegriffs zur Verfügung. Auf der linken Seite befinden sich zwei Auswahlfelder, mit denen Sie jeweils festlegen können, wie sich Ihre Suchbegriffe zu den vorliegenden Zellinhalten einer Spalte verhalten sollen.

Durch den Punkt im Kontrollkreis vor `UND` bzw. `ODER` legen Sie fest, wie Ihre beiden Suchbegriffe miteinander verknüpft werden. `UND` bedeutet, dass ein zutreffender Zellinhalt beide Suchbegriffe beinhalten muss. `ODER` bedeutet hingegen, dass ein zutreffender Zellinhalt nur einen der beiden Suchbegriffe aufweisen darf.

Abschließend sollen zu diesem Dialogfenster die Verhältnisoperatoren erläutert werden, mit denen Sie die gewünschte Relation eines Suchbegriffs zu den vorhandenen Zellinhalten einer Spalte definieren können. Dafür stehen im Aufklappmenü der beiden Auswahlfelder folgende Operatoren zur Verfügung:

Operator |Bedeutung
--|--
gleich |Suchbegriff und Zellinhalt der Spalte müssen identisch sein.
nicht gleich |Suchbegriff und Zellinhalt der Spalte dürfen nicht identisch sein.
ist kleiner als |Der Suchbegriff muss weniger Zeichen bzw. einen geringeren Zahlenwert haben als der Zellinhalt.
ist kleiner oder gleich |Der Suchbegriff muss weniger oder die selbe Anzahl Zeichen bzw. einen kleineren oder den gleichen Zahlenwert haben wie der Zellinhalt.
ist größer als |Der Suchbegriff muss mehr Zeichen bzw. einen größeren Zahlenwert haben als der Zellinhalt.
ist größer oder gleich |Der Suchbegriff muss mehr oder die selbe Anzahl an Zeichen bzw. einen größeren oder gleichen Zahlenwert haben wie der Zellinhalt.
wie |Der Zellinhalt enthält die selbe Zeichenfolge wie der Suchbegriff.
nicht wie |Der Zellinhalt enthält nicht die selbe Zeichenfolge wie der Suchbegriff.
ist leer |Die Zelle muss leer sein.
ist nicht leer |Die Zelle darf nicht leer sein

Um den erzeugten Filter zu aktivieren, bestätigen Sie bitte Ihre Angaben im Dialogfenster `Benutzerdefinierter Filter` mit `OK`. Die Liste, für die der Filter erstellt wurde, zeigt nun die zutreffenden Einträge.

Sie können diese Liste nun weiter filtern, indem Sie zusätzlich einen benutzerdefinierten Schlüssel für die nächste Spalte erzeugen. Ihre aktuell gesetzten Filterparameter erscheinen wieder in dem grauen Balken am unteren Rand des Listenfensters.

## Listeneinträge auswählen

Listeneinträge müssen Sie auswählen, wenn Sie mit diesen Einträgen bestimmte Aktionen durchführen wollen. Einträge wählen Sie aus, indem Sie diese markieren. Sie haben verschiedene Möglichkeiten, um in Stammdaten- und Vorgangslisten einzelne oder mehrere Eintrage zu markieren:

Auswahl|Vorgehen
--|--
einzelne Einträge|Wählen Sie einzelne Einträge aus, indem Sie mit der linken Maustaste die betreffende Zeile markieren.
mehrere Einträge|Wählen Sie mehrere Einträge aus, indem Sie die Taste `Strg` gedrückt halten und mit der linken Maustaste die zugehörigen Zeilen markieren.
fortlaufende Reihe von Einträgen|Wählen Sie eine fortlaufende Reihe von Einträgen aus, indem Sie die `Shift-Taste` gedrückt halten und mit der `linken Maustaste zunächst die Anfangs- und dann die Endzeile` dieser Reihe markieren.
alle Einträge|Wählen Sie alle Vertreter aus, indem Sie die Schaltfläche `Alles Markieren` betätigen, die sich im Dialogfenster links unter der Auswahlliste befindet.

Mit den ausgewählten Einträgen können Sie nachfolgend bestimmte Aktionen durchführen z.B. entfernen oder ausdrucken.

![Hier wurden mithilfe der Schalfläche `Alles markieren` alle Einträge der Liste `Aktuelle Vorgänge` ausgewählt. ](/assets/images/bibliothek/listen06.png)

## Berichte ausdrucken

In allen Stammdaten- und Vorgangslisten können Sie Berichte der gesamten Liste bzw. einzelner oder mehrerer Listeneinträge ausdrucken. Für den Listenausdruck stehen Ihnen diverse Berichtsdateien zur Verfügung, die bei der Installation im Programmverzeichnis von MAGELLAN-BIBLIOTHEK hinterlegt werden.

Um einen Listenbericht auszudrucken, gehen Sie bitte folgendermaßen vor:

1. Markieren Sie den gewünschten Listenbereich und betätigen Sie in der Menüleiste unter `Start > Berichte drucken`.
2. Wählen Sie aus dem erscheinenden Dialogfenster `Berichte ausdrucken` die gewünschte Berichtsdatei.
3. Betätigen Sie die Schaltfläche `Berichte drucken` und wählen Sie im erscheinenden Dialogfenster Ihre Druckoptionen.
4. Bestätigen Sie abschließend mit `OK`.

Der gewünschte Bericht wird nun für den ausgewählten Listenbereich gedruckt.

![Hier sehen Sie einen Ausschnitt der Seitenvorschau des Druckberichts `Medienliste (Standard).rpt`, der für die Liste der Bücher/ Medien angefertigt werden kann ](/assets/images/bibliothek/listen07.png)

## Listen exportieren

Sie haben die Möglichkeit Stammdaten- und Vorgangslisten ganz oder teilweise nach Excel bzw. HTML zu exportieren. Der Export nach Excel steht für alle Listen zur Verfügung. Der HTML-Export kann hingegen nur für die Liste der `Bücher/Medien` sowie für die beiden Vorgangslisten in der Ansicht `Vorgänge` erfolgen.

Um einen bestimmten Listenbereich nach Excel zu exportieren, führen Sie bitte folgende Schritte aus:

1. Markieren Sie den gewünschten Listenbereich und betätigen Sie die Schaltfläche `Export nach Excel` .
2. Wählen Sie im erscheinenden Dialogfenster ein Zielverzeichnis aus dem Windows-Explorer und geben Sie im Feld `Dateiname` den Namen der Exportdatei an.
3. Bestätigen Sie Ihre Eingaben mit `Speichern`.

![Hier soll die Liste `Aktuelle-Vorgänge` nach Excel exportiert werdenS.](/assets/images/bibliothek/listen08.png)

Die Export-Datei wird nun erstellt und automatisch in Excel geöffnet. Von hier aus können Sie die Liste nun weiter bearbeiten oder ausdrucken.

![Hier sehen Sie einen Excel-Export der Liste `Aktuelle-Vorgänge`.](/assets/images/bibliothek/listen09.png)

Um einen bestimmten Listenbereich nach HTML zu exportieren, gehen Sie bitte folgendermaßen vor:

1. Markieren Sie den gewünschten Listenbereich und betätigen Sie die Schaltfläche `Export nach HTML`.
2. Wählen Sie im erscheinenden Dialogfenster ein Zielverzeichnis aus dem Windows-Explorer und geben Sie im Feld `Dateiname` den Namen der Exportdatei an.
3. Bestätigen Sie Ihre Eingaben mit `Speichern`
4. Die Export-Datei wird nun erstellt und automatisch in Ihrem Standardbrowser geöffnet.

![Hier sehen Sie einen HTML-Export der Liste `Aktuelle Vorgänge`.](/assets/images/bibliothek/htmlexport.png)
